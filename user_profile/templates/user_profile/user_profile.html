{% extends "base.html" %}
{% load static %}
{% load emoji_tags %}


{% block extra_js %}
<script src="{% static 'user_profile/js/user-profile.js' %}"></script>

{% endblock %}


{% block content %}
<div class="user-profile ">
    <div class="profile-container scrollable-div">
        <div class="w-100 text-center mb-3">
        {% if user_profile.profile_picture %}
        <img class="profile_pic" src="{{ user_profile.profile_picture.url }}" alt="profile image">
        {% else %}
        <img class="profile_pic" src="{% static 'noimage.png' %}" alt="default image">
        {% endif %}
    </div>
    <h2>{{ user_profile.user.username }}</h2>
    <h5 class="status ">Current Status: {{ user_profile.status }}</h5>

    <hr>
    {% if user_profile.user.username == request.user.username %}
    <div class="links-container">
        <div class="links-heading">Menu <i class="fa fa-link fa-1x"></i></div>
        <div class="links-body pb-2">
            <button class="btn btn-ci profile-img-modal" type="submit"><i class="glyphicon glyphicon-ok-sign"></i>
                Change profile Picture</button>
            <button class="btn btn-ci status-update-btn" type="submit"><i class="glyphicon glyphicon-ok-sign"></i>
                Change status</button>
            <button class="btn btn-ci edit-profile-btn d-flex d-sm-none d-lg-none">Edit Profile</button>
            <button class="btn btn-ci view-save-posts-btn">Saved Posts</button>
        </div>
    </div>
    <!-- </div> -->
    {% endif %}
    {% if user_profile.bio %}
        <div class="links-container">
            <div class="links-heading">Bio</div>
            <div class="links-body"><p>{{ user_profile.bio }}</p>
            </div>
        </div>
    {% endif %}
    {% if user_profile.website %}
        <div class="links-container">
            <div class="links-heading">Website <i class="fa fa-link fa-1x"></i></div>
            <div class="links-body"><a href="https://{{ user_profile.website }}" target="_blank">{{ user_profile.website }}</a>
            </div>
        </div>
    {% endif %}
    {% if user_profile.website %}
        <div class="links-container">
            <div class="links-heading">Linkdin <i class="fa fa-link fa-1x"></i></div>
            <div class="links-body"><a href="https://{{ user_profile.linkedin }}" target="_blank">
                {{ user_profile.linkedin }}</a></div>
        </div>
    {% endif %}

    {% if user_profile.website %}
        <div class="links-container">
            <div class="links-heading">Github <i class="fa fa-link fa-1x"></i></div>
            <div class="links-body"><a href="https://{{ user_profile.github }}" target="_blank">
                {{ user_profile.github }}</a></div>
        </div>
    {% endif %}
</div>
    <div class="update_profile_container scrollable-div d-none d-sm-flex d-lg-flex">

        <div class="custom-box fixed-header d-flex flex-dir-row d-none d-sm-none d-lg-none">
            <button class="btn mr-3 close-edit-profile-btn">X</button>
            <h3>Edit Profile</h3>
        </div>

        <div class="p-3">
            <h1 class="h1">Personal Info</h1>
            <hr>
            <form class="form" method="post" action="{% url 'user_profile' %}" id="registrationForm">
                {% csrf_token %}
                {{ Edit_profile_form.as_p }}
                <button class="btn btn-lg btn-success" type="submit"><i class="glyphicon glyphicon-ok-sign"></i>
                    Update</button>
            </form>
        </div>
    </div>

    <div class="saved-posts-container d-none">
        <div class="custom-box fixed-header d-flex flex-dir-row">
            <button class="btn mr-3 saved-posts-close-btn">X</button>
            <h3>Saved Post's</h3>
        </div>
        <div class="py-5 px-3 scrollable-div h-100">
            {% if posts %}
            {% include 'user_profile/saved-posts.html' %}
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}

{% block postloadjs %}
    <script>
        let profileImgModal = 
            `{% if user_profile.profile_picture %}
                <img class="profile_pic" src="{{ user_profile.profile_picture.url }}" alt="profile image">
                {% else %}
                <img class="profile_pic" src="{% static 'noimage.png' %}" alt="default image">
                {% endif %}
                <form class="form" method="post" enctype="multipart/form-data"  data-url='{% url "update_profile_image" %}'>
                    {% csrf_token %}
                    {{ profile_image_form.as_p }}
                    <button class="sub-form" type="submit" data-dismiss="modal">Update Profile Image</button>
                </form>
            `;
    
        let statusModalBody = 
            `<form class="form" method="post" data-url='{% url "update_status" %}'>
                {% csrf_token %}
                {{ status_form.as_p }}
                <button class="sub-form" type="submit" data-dismiss="modal">Update Status</button>
             </form>
            `;
    </script>

{% endblock %}